@page "/test"
@using System.Security.Claims
@using M133BlazorServerApp.Data
@using Microsoft.AspNetCore.Components.Server.ProtectedBrowserStorage
@using Microsoft.AspNetCore.Authorization

@inject ProtectedSessionStorage ProtectedSessionStore
@attribute [Authorize]
@inject NavigationManager NavigationManager
@inject IJSRuntime JsRuntime


<AuthorizeView>
    <Authorized>
        <style>


            .gameGrid {
                display: flex;
                flex-direction: row;
                flex-wrap: wrap;
                align-content: flex-start;
                justify-content: center;
                align-items: flex-start;
                margin:20px;
            }

            .championBox {
                background-color: #212529;
                box-shadow: #333 1px 0 10px;
                border-radius: 10px;
                margin: 8px;
                width: calc((3.5vw + 5.5vh) / 2);
                height: calc((3.5vw + 5.5vh) / 2);
                overflow: hidden;
                -webkit-transition: 0.6s;
                -webkit-transform-style: preserve-3d;
                -moz-transition: 0.6s;
                -moz-transform-style: preserve-3d;
                -o-transition: 0.6s;
                -o-transform-style: preserve-3d;
                transition: 0.6s;
                transform-style: preserve-3d;
                position: relative;
                -webkit-perspective: 1000;
                -moz-perspective: 1000;
                -o-perspective: 1000;
                perspective: 1000;
            }

                .championBox:hover {
                    cursor: pointer;
                }

            .front {
                z-index: 2;
            }

            .back, .front {
                width: 115%;
                height: 115%;
                object-fit: cover;
                box-shadow: #333 1px 0 10px;
                position: relative;
                top: -7.5%;
                left: -7.5%;
            }

            .front, .back {
                -webkit-transition: opacity 0.3s ease-in-out;
                -moz-transition: opacity 0.3s ease-in-out;
                -o-transition: opacity 0.3s ease-in-out;
                transition: opacity 0.3s ease-in-out;
                position: absolute;
            }

            article.content.px-4 {
                background-image: url(../images/gras1.jpeg);
                background-size: 100%;
            }
        </style>
            @*<h3 class="text-center gameTitle">Guessing Game</h3>*@
            <div class="gameGrid">
                @{
                    string rootpath = System.IO.Path.Combine(System.IO.Directory.GetCurrentDirectory(), "wwwroot\\images\\icons");
                    DirectoryInfo d = new DirectoryInfo(rootpath);



                    foreach (var file in d.GetFiles("*.png"))
                    {

                        var src = "images\\icons\\" + file.Name;

                        var output = file.Name.Replace(".png", "");

                        <div id="@output" class="championBox" @onclick='() => FlipImage(output)'>
                            <img class="front" src="@src" />
                            <img class="back" src="images/backSide.png">
                        </div>


                    }
                }
            </div>

    </Authorized>
    <NotAuthorized>
        Guessing Game only for logged in users
    </NotAuthorized>
</AuthorizeView>

@code {
    private async Task FlipImage(string id)
    {
        await JsRuntime.InvokeVoidAsync("flipImage", id);
    }
}